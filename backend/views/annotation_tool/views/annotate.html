<!DOCTYPE html>
<html>
<head>
  <title>McGill Robotics Lens</title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link
    href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,700'
    rel='stylesheet' type='text/css'>
  <style type="text/css">
    table, th, td {
      border: 1px solid black;
      border-collapse: collapse;
    }
    h3, p, div {
      text-align: center;
    }
    tr {
      padding: 15px;
    }
    th, td {
      padding: 15px;
      text-align: center;
      vertical-align: center;
    }
    div.displayed {
      display: block;
      margin-left: auto;
      margin-right: auto;
    }

    h1#title {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 100;

      margin: 0;

      font-family: sans-serif;
      font-size: 1rem;
    }

    #img-container {
      position: absolute;
      top: 0; bottom: 0; left: 0; right: 60px;

      background-color: #777;

      overflow-y: auto;
    }
    #sidebar {
      box-sizing: border-box;

      position: absolute;
      top: 0; bottom: 0; right: 0;
      width: 140px;
      padding: 10px;

      background-color: #1b1b1b;
    }
    #sidebar #mr-logo {
      max-width: 100%;
      margin-bottom: 10px;
    }
    #sidebar ul {
      list-style: none;
      padding: 0; margin: 0;
    }
    #sidebar ul #bottom {
      position: absolute;
      bottom: 0;
    }
    #sidebar ul li {
      margin-bottom: 10px;
    }
    #sidebar ul li h4 {
      color: #777;
      font-family: "Open Sans Condensed", sans-serif;
      margin: 0;
    }
    #sidebar ul li button {
      box-sizing: border-box;

      width: 120px;
      height: 40px;
      line-height: 36px;
      vertical-align: top;

      border: 2px solid #ffffff;
      background-color: #1b1b1b;

      font-family: "Open Sans Condensed", sans-serif;
      font-size: 1rem;
      font-weight: bold;
      text-transform: uppercase;
      color: #f9f9f9;

      outline: none;

      transition: background-color 0.15s;
    }
    #sidebar ul li button.big {
      height: 80px;
      line-height: 74px;

      font-size: 1.5rem;
    }
    #sidebar ul li button:disabled {
      border: 2px solid #999;
      color: #999;
      cursor: not-allowed;
    }
    #sidebar ul li button i {
      display: inline-block;
      vertical-align: top;
      font-size: 1.1rem;
      margin-top: 8px;

      color: #d9d9d9;
    }
    #sidebar ul li button:active, #sidebar ul li button.active {
      background-color: #fff;
      color: #1b1b1b;
      transition: background-color 0.15s;
    }
    #sidebar ul li hr {
      border: none;
      border-top: 1px solid #C9C9C9;
    }
    #help {
      position: absolute;
      bottom: 0; left: 0; right: 140px;

      padding: 7px; margin: 0;

      background-color: #AAA;
      border-top: 1px solid #666;

      font-family: sans-serif;
      font-size: 0.9rem;
    }

    #annotation-header {
      background-color: #CDCCCC;
    }
    #annotate-img {
      width: 600px;
      height: 450px;
      margin-top: 40px;

      background-size: 100% auto;
      background-repeat: no-repeat;

      border: 1px solid #444;
      box-shadow: 0px 1px 3px rbga(0, 0, 0, 0.1);
    }

    #dragShape {
      border: 1px dashed red;
      position: absolute;
      pointer-events: none;
    }
    #dragShape.circle {
        border-radius: 100%; /* Turn it into an ellipse */
    }
  </style>

  <!--
    @TODO : add circles, and also add arbitrary polygons
    @TODO : angled rectangles
    @TODO : want to be able to say there is nothing - HTML Element (Button) &
    Onclick Function.
     * Need to add the onclick functionality
     * Need to be able to actually submit tags and annotations (Server side
     * post configuration)
     * Need to be able to visualize the currently existing tags / annotations
     *  of the image
    @TODO : Selecting instead of just free form input
  -->


  <!--
    The following script tag fetches the Lens.js script from
    annotation_tool/javascript. The script contains the pages
    event listeners and is the driver of the annotation tool.
    Its entry point is the Lens.methods.init method, which is
    triggered by the onload event of the body.
   -->
  <script type="text/javascript" src="/lens?script=Lens.js"></script>


  <!--
    The image class contains the container for the image
    as well as the Annotation table data.
  -->
  <script type="text/javascript" src="/lens?script=Image.js"></script>

  <!--
    The Annotation Table is the Object that allows us to
    keep track of all annotations.
  -->
  <script type="text/javascript" src="/lens?script=AnnotationTable.js">
  </script>

  <!--
    The Annotation is an Object template for the Annotations of the image.
  -->
  <script type="text/javascript" src="/lens?script=Annotation.js"></script>

  <script type="text/javascript">
    function updateToolUI() {
      var rectangleTool = document.getElementById('tool-rectangle');
      var circleTool = document.getElementById('tool-circle');
      var polygonTool = document.getElementById('tool-polygon');

      rectangleTool.className = '';
      circleTool.className = '';
      polygonTool.className = '';

      switch (Lens.shapeType) {
        case 'rectangle':
          rectangleTool.className = 'active';
          break;
        case 'circle':
          circleTool.className = 'active';
          break;
        case 'polygon':
          polygonTool.className = 'active';
          break;
      }
    }
  </script>

</head>
<body onload="Lens.methods.init()">
  <div id="img-container">
    <svg
      id="annotate-img"
      class="annotate-img"
      xmlns="http://www.w3.org/2000/svg">
    </svg>
  </div>
  <div id="sidebar">
      <svg id="mr-logo" data-name="mr-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 455 455"><defs><style>.cls-1{fill:#fff;fill-rule:evenodd;}.cls-2{fill:none;}</style></defs><title>mr_logo</title><path id="_Compound_Path_" data-name="&lt;Compound Path&gt;" class="cls-1" d="M121.33,367.07h-72L30.19,378.36a5,5,0,0,0-2.46,4.31v27.6H142.94v-27.6a5,5,0,0,0-2.46-4.31l-19.14-11.29h0Zm230.46-252-0.06,158.35a36,36,0,0,1,43.13,0l0.06-158.34A36,36,0,1,0,351.79,115.11ZM49.33,359.87h72V335.19a5,5,0,0,0-2.47-4.31l-11.93-7h0V176.61L77.74,128.78a43,43,0,0,1-14-5.1V323.86h0l-11.94,7a5,5,0,0,0-2.47,4.31v24.67Zm302,25.42v17.36a5,5,0,0,1-4.22,4.94l-12.25,1.93a5,5,0,0,1-5.69-4l-13-67.52a5,5,0,0,1,1.37-4.48l21.17-21.17a36.08,36.08,0,0,0,22.11,23.71l-9.51,9.51v39.72Zm-6.84-266.85a43.31,43.31,0,0,1-9.17-11.54L232.7,274.48l4.18,6.86a43.23,43.23,0,0,1,29.65,20.55l78-127.33V118.44Zm63.54,194.16-6.24-6.23a28.81,28.81,0,1,0-21.89,23.91l15,15v57.34a5,5,0,0,0,4.22,4.94l12.6,2a5,5,0,0,0,5.69-4L430.39,338a5,5,0,0,0-1.38-4.48ZM233.75,288.15L118.62,100a36,36,0,1,0-37.08,22.07L196.28,309.58A36,36,0,1,0,233.75,288.15Z"/><rect id="_Slice_" data-name="&lt;Slice&gt;" class="cls-2" x="-5.61" y="450" width="486" height="57"/></svg>
    <ul>
      <li><h4>SELECTION TOOLS</li>
      <li>
        <button type="button" id="tool-rectangle" class="active"
          onclick="Lens.methods.setShapeType('rectangle'); updateToolUI();">
          Rectangle
        </button>
      </li>
      <li>
        <button type="button" id="tool-circle"
          onclick="Lens.methods.setShapeType('circle'); updateToolUI();">
          Circle
        </button>
      </li>
      <li>
        <!-- DISABLED FOR NOW -->
        <button type="button" id="tool-polygon" disabled
          onclick="Lens.methods.setShapeType('polygon'); updateToolUI();">
          Polygon
        </button>
      </li>

      <div id="bottom">
        <li>
          <button type="button" class="big"
            onclick="Lens.methods.submit(true);">
              Submit
          </button>
        </li>
        <li>
          <button type="button" onclick="Lens.methods.submit(false);">
              Skip
          </button>
        </li>
      </div>
    </ul>
  </div>

  <p id="help">
    <b>Help: </b>
    Click and drag on the image to select a region you wish to annotate.
    You will be prompted to enter a label for the selected region.
  </p>

  <!-- Configure this button to set the 'Tags' of the image -->
</body>
</html>
