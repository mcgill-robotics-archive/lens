<!DOCTYPE html>
<html>
<head>
  <title>McGill Robotics Lens</title>
  <style type="text/css">
    #annotate-img{
      background-image: url("http://dreamatico.com/data_images/cat/cat-4.jpg");
      background-size: 100% 100%;
      height: 400px;
      width: 600px;
    }
  </style>
  <script type="text/javascript">
    'use strict'
    var vertices = {};
    vertices.startX;
    vertices.startY;
    vertices.endX;
    vertices.endY;

    var inputData;
    
    document.addEventListener("DOMContentLoaded", initializeImageListeners, false);
    
    function initializeImageListeners (event) {
      var image = document.getElementById('annotate-img');
      
      image.addEventListener('mousedown', function (event) {
        vertices.startX = event.offsetX;
        vertices.startY = event.offsetY;
      });

      image.addEventListener('mouseup', function (event) {
        if (vertices.startX !== undefined && vertices.startY !== undefined) {
          vertices.endX = event.offsetX;
          vertices.endY = event.offsetY;
          drawRect();
          promptUserForLabel();
          appendInput();
        }
      });

    }

    document.addEventListener('mouseup', function (event) {
      unSetValues();
    });

    function promptUserForLabel() {
      // Add small pop up window to page
      // Basically this is where all of the code for the labeler will go
      /* it will be a little pop up with an onclick event handler that will
      take whatever the user enters in the `label` field and append it to the JSON 
      object that we're eventually going to submit
      */
      
    }

    function drawRect () {
      for (var keys in vertices) {
        if (vertices.hasOwnProperty(keys)){
          console.log(keys + ' is: ' + vertices[keys]);
        }
      }
    }

    function appendInput() {
      inputData = {};
      inputData.v1x = vertices.startX;
      inputData.v1y = vertices.startY;
      inputData.v2x = vertices.endX;
      inputData.v2y = vertices.endY;
      
    }

    function unSetValues () {
      for (var keys in vertices) {
        if (vertices.hasOwnProperty(keys)) {
          vertices[keys] = undefined;
        }
      }
    }

  </script>
</head>
<body>
  <div id="annotate-img"></div>
  

  <form>
    <!--JSON input-->
    <input type="hidden" name="labels" value="[]">
    <input type="submit" value="Submit">
  </form>

</body>
</html>
